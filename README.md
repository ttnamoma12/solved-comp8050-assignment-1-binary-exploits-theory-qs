Download Link: https://assignmentchef.com/product/solved-comp8050-assignment-1-binary-exploits-theory-qs
<br>
For this assignment, we will use the C program provided below, <strong>assignment1.c </strong>. Compile it with the usual command:

gcc -g -O0 -mpreferred-stack-boundary=2    -m32      -fnostack-protector -z execstack  -D_FORTIFY_SOURCE=0  assignment1.c –o assignment1.o

Also ensure that you have disabled ASLR:

sudo sysctl -w kernel.randomize_va_space=0

If you have not already done so in the labs, you may need to install the following packages first too:

sudo apt-get install libc6-dev libc6-dev-i386 gcc-multilib




<h2>Question 1 –</h2>

question1.c:

<table width="569">

 <tbody>

  <tr>

   <td width="569">1.      #include &lt;stdlib.h&gt;2.      #include &lt;unistd.h&gt; 3.  #include &lt;stdio.h&gt; 4.  #include &lt;string.h&gt; 5.6.      void partialwin()7.      {8.      printf(“Achieved 1/2!
”); 9.  }10.11.    void fullwin()12.    {13.    printf(“Achieved 2/2!
”); 14. }15.16.     void vuln()17.     {18.     char buffer[36];19.20.    gets(buffer);21.    printf(“Buffer contents %s
”, buffer) 22. }</td>

  </tr>

 </tbody>

</table>

<ol start="23">

 <li></li>

 <li>int main(int argc, char **argv)</li>

 <li>{</li>

 <li>vuln();</li>

 <li>}</li>

</ol>

<strong> </strong>

<strong>What you must do: </strong>

You must perform an attack on the program and cause it to output both “Achieved 1/2!” and “Achieved 2/2!” from the functions patrialwin() and fullwin(), in that order,  in a single run of the program.. You must document your approach clearly in the following way:




<ul>

 <li>Provide a large paragraph, or two, which gives a high-level description of the approach you intend to take in order to achieve your attack. It should be clear and concise. If you started with one approach, but swapped midway to another after realising something, describe both the initial idea and your final one here too.</li>

</ul>




<ul>

 <li>Show step-by-step how you performed your attack. You should include screenshots of your input/output (e.g. using the Windows “snipping tool”) and provide short comments explaining <strong>why</strong> you did each action. For example:</li>

</ul>




Sample Command (should be screenshotted with the output included): x24x $esp Sample explanations for why:




I used it to show the stack. <strong>(BAD – this is what you did, not why you did it) </strong>

<strong> </strong>

I used it to show the contents of 24 addresses on the stack, in order to identify the exact location of the buffer and calculate how much overflow was necessary to write over the saved base pointer. <strong>(GOOD! – here the purpose of using a command to show the stack is explained!) </strong>




<ul>

 <li><strong>You must include a detailed diagram of the current state of the stack at each major step, starting from the initial state before your attack begins. </strong>The diagrams should show all of the relevant elements on the stack (similar to those provided in the lecture notes).</li>

</ul>




<ul>

 <li>You must show how you would change the code to <strong>fix all the vulnerabilities</strong> in the program. Provide a brief description of why your changes fix the issues.</li>

</ul>




<strong>Question 2 </strong><strong>–</strong>

question2.c:

<table width="569">

 <tbody>

  <tr>

   <td width="569">1.      #include &lt;stdlib.h&gt;2.      #include &lt;unistd.h&gt; 3. #include &lt;stdio.h&gt; 4. #include &lt;string.h&gt; 5.6. int grade;7.8.      void securegrading()9.      {10.    if( grade &lt; 40 )11.    {12.    printf(“Usual grade attained.
”);13.    }14.    else if( grade &lt; 100 )15.    {16.    printf(“Excellent grade attained!
”);17.    }18.    else if( grade == 100 )19.    {20.    printf(“Perfect grade attained!
”);21.    } 22.   exit(1);23.24. }25.26.     int main(int argc, char **argv)27.     {28.     char input[48];29.30.   grade = 10;31.32.    gets(input);33.    printf( “User input:” ); 34.   printf( input );35.36. }</td>

  </tr>

 </tbody>

</table>




<strong>What you must do: </strong>

You must perform an attack on the program and cause it to run line 20 and output “Perfect grade attained!”. As you can see, the securegrading() function is not normally called at all, so some form of redirection will be necessary. You must document your approach clearly in the following way:

<ul>

 <li>Provide a large paragraph, or two, which gives a high-level description of the approach you intend to take in order to achieve your attack. It should be clear and concise. If you started with one approach, but swapped midway to another after realising something, describe both the initial idea and your final one here too.</li>

</ul>




<ul>

 <li>Show step-by-step how you performed your attack. You should include screenshots of your input/output (e.g. using the Windows “snipping tool”) and provide short comments explaining <strong>why</strong> you did each action. For example:</li>

</ul>




Sample Command (should be screenshotted with the output included): x24x $esp Sample explanations for why:




I used it to show the stack. <strong>(BAD – this is what you did, not why you did it) </strong>

<strong> </strong>

I used it to show the contents of 24 addresses on the stack, in order to identify the exact location of the buffer and calculate how much overflow was necessary to write over the saved base pointer. <strong>(GOOD! – here the purpose of using a command to show the stack is explained!) </strong>




<ul>

 <li>You must show how you would change the code to <strong>fix all the vulnerabilities</strong> in the program. Provide a brief description of why your changes fix the issues.</li>

 <li>Question 3 –</li>

 <li>Provided a detailed description of Address Space Layout Randomization (ASLR), explaining what it is, as well as its effectiveness and limitations as a security solution.</li>

</ul>

<ol>

 <li>Evaluate whether or not ASLR is an effective defence against <em>Stack Buffer Overflow Attacks</em> (a.k.a. Stack Smashing).</li>

 <li>Evaluate whether or not ASLR is an effective defence against <em>Format String Attacks</em>.</li>

</ol>

<ul>

 <li>Provided a detailed description of a Non-executable Stack, explaining what it is, as well as its effectiveness and limitations as a security solution.</li>

</ul>

<ol>

 <li>Evaluate whether or not a Non-executable Stack is an effective defence against <em>Stack Buffer Overflow Attacks</em> (a.k.a. Stack Smashing).</li>

 <li>Evaluate whether or not a Non-executable Stack is an effective defence against <em>Format String Attacks</em>.</li>

</ol>

<h2>Question 4 –</h2>

<ul>

 <li>Thoroughly describe what is meant by a Structured Exception Handler (SEH) Attack, including the risks posed for a program vulnerable to this type of attack.</li>

</ul>




<ul>

 <li>Explain what <em>Structured Exception Handling Overwrite Protection (SEHOP)</em> is and clearly show how it protects against SEH Attacks.</li>

</ul>


